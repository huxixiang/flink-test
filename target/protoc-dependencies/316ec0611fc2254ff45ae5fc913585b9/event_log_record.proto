syntax = "proto3";
option java_outer_classname = "EventRecord";

package com.red.platform.log.event;


message Record {
    string version = 1;
    RecordHeader header = 2;
    bytes body = 4;
}

message RecordHeader {
    int64 timestamp = 1;
    double weight = 2;
    string app_id = 3;
    string body_version = 4;
    MessageType message_type = 5;
    Endpoint endpoint = 6;
    HttpExtraInfo http_extra_info = 7; //如果endpoint是 tracker/lng的话这里会设置数据
}

enum MessageType {
    JSON = 0;
    PB = 1;
}

enum Endpoint {
    TRACKER = 0; //[tracker]前端打点业务
    LNG = 1; //[lng]数据收集业务
    REX = 2; //[rex]后端日志业务
}

message HttpExtraInfo {
    // System.now()
    int64 collect_tstamp = 1;
    string collect_hostname = 2;
    string http_remote_ip = 11;
    // GET/POST/PUT
    string http_request_method = 12;
    // /api/ping
    string http_request_uri = 13;
    // 200/400/500
    int32 http_status = 14;
    int32 http_body_bytes_sent = 15;
    string http_referer = 16;
    string http_user_agent = 17;
    string client_lang = 18;
    int32 validate_result_code = 23;
    map<string, string> validate_extra_info = 24;
}
