syntax = "proto3";
package fingerprint.android;
option java_package="com.xy.fingerprint.android";
option java_outer_classname = "AndroidModelV2";

enum field_desc {
    no_error = 0; // 未发生异常
    time_out =1;  // 异步获取时，在指纹上报之前，未获取到
    os_version_too_old =2; // 系统版本太低，无法获取
    os_version_too_new =3; // 系统版本太高，无法获取
    no_os_permission = 4; //  无系统权限
    no_user_permission = 5; // 用户协议限制
    occurred_unknown_exception =6; // 发生未知异常
}

message Model {
    // 名称 android，ios
    string name =1;
    // 版本
    string version =2;
    //指纹id 
    string fid = 3;
    // 采集时间
    uint64 timestamp = 4;
   // APP 信息 
    App app = 5;
    // 系统信息
    System sys = 6;
    // 系统状态信息
    State state = 7;
    // 传感器信息
    Motion motion = 8;
    // 网络信息
    TelephonyNetwork network = 9;
    // java运行时信息
    JavaRuntime java = 10;
    // 扩展
    Extension ext =11;
    // appid
    uint32 appid =12;

}
message Extension{
    string device_id =1;
    string shumei_fingerprint=2; 
    string session_id =3;
    string js_fingerprint=4;
}
message System {
    // android 版本信息
    int32 version = 1;
    // 是否root
    bool rooted = 2;
    // 启动时间
    int64 boot_time = 3;
    // 语言
    string lang = 5;
    // 支持的指令集
    string cpu_abi = 6;
    // 进程名称
    string process_name = 7;
    // 分辨率宽
    int32 width_pixels = 8;
    // 分辨率高
    int32 height_pixels= 9;
    // 屏幕密度
    double density = 10;

    string model =11;
    string board =12;
    string boot_loader =13;
    string brand =14;
    string device =15;
    string display = 16;
    string fingerprint=17;
    string hardware =18;
    string host =19;
    string manufacturer =20;
    string tags =21;
    string id = 22;
    int64 time =23;
    bool is_emulator =24;
    
    uint64 memory_size =25; 
    uint64 storage_size =26;// inner storage
    uint64 external_storage_size =27;//external storage size
    string imsi = 28; // android imsi
    
    bool xposted_existed = 29;//  has exited xposed 
    string android_id = 30;
    bool is_support_camera_flash =31; // is support camera flash
    string ro_board_platform = 32; // ro.board.platform

    // 用来判断xposed是否存在,非0即存在；
    // 1.使用findClass方式获取，2.使用throwException方式获取
    // 如果多种方式都判断得到，使用位或方式组合

    int32 xposed_result = 33;

    // 用来检测是否运行在类似VirtualAPP的虚拟容器中（如VirtualApp ，双开精灵等等）,非0即存在；
    // 1. 使用文件权限方式检测
    // 2. 使用ps命令+唯一uid方式获取
    // 如果多种方式都判断得到，使用位或方式组合

    int32 virtual_app_result =34;

    // 运行中的进程，通过系统API获取得到
    string running_process_by_api = 35;

    // 运行中的进程，通过ps命令获取得到
    string running_process_by_command = 36;

}

message App {
    string identifer = 1; // iOS: com.xingin.discover
    string version = 2; // iOS: 5.51
    string build = 3; // iOS: 5510170
    
    string private_file_path =4;//android private files dir path
    string apk_path =5; // android apk path
    uint64 signature=6; // android signature of certifacate for apk
    uint64 apk_crc =7;//android main dex crc in zip
    string channel = 8;// android channel

}

enum battery_state_e {
    battery_state_unknown = 0;
    battery_state_unplugged = 1;
    battery_state_charging = 2;
    battery_state_full = 3;
}

enum sim_state_e {
    sim_state_unknown =0;
    sim_state_absent=1;
    sim_state_pin_required=2;
    sim_state_puk_required=3;
    sim_state_network_locked=4;
    sim_state_ready=5;
    sim_state_not_ready=6;
    sim_state_perm_disable=7;
    sim_state_card_io_error=8;
    sim_state_card_restricted=9;
}

message State {

    // 可用内存
    uint64 free_memory =1;
    // 总内存
    uint64 total_memory=2;
    
    // 内存阈值，如果低于阈值为低内存
    uint64 threshold_memory=3;
    // 是否为低内存
    bool is_low_memory =4;
    // 电池容量 微安时
    uint64 charge_count=5;
    // 电流 微安 positive：充电，negative:正在使用，费电
    uint64 charge_current_average = 6;
    // 电流 微安 瞬时
    uint64 charge_current_now =7;
    // 电池电量 百分比 整型
    uint64 charge_capacity =8;
    // 是否正在充电
    bool   charging =9;
    uint64 free_storage=10; // free internal storage
    uint64 free_external_storage=11;//free external storate
    uint64 brightness =12; // screen brighness
    sim_state_e sim_state =13;// sim state
    // 电池状态
    battery_state_e battery_state = 26; 
    
    uint64 dev_opened_count =27; // dev mode was opened by user.
    bool is_ptraced = 28; // the process was ptraced by debugger.
    int32 accessibility_enable_status = 29;//// android 辅助工能是否打开; -1: 取值时发生了 SettingNotFoundException异常。 其他值为设备数据库中的值(一般，1为打开)
    string accessibility_enabled_services = 30; // android 手机启用的辅助Services列表

}
message JavaRuntime {
    // 安装应用列表
    string install_apps=1;
    // 是否可调试
    bool debugable =2;
    
    //  /proc/{pid}/maps 下存在 libsubstrate.so 
    bool maps_exist_cydia_so =3;
    // libsubstrate-vm_so
    bool maps_exist_cydia_dvm_so=4;
    // libxposed_art.so
    bool maps_exist_xposed_art_so=5;

    // app list 加密后
    string app_list = 6;

}

message Motion {
    // 传感器列表
    string sensor_list = 1;
    // 加速计 x 轴 速度差
    double accelerometer_x = 2;
    double accelerometer_y = 3;
    double accelerometer_z = 4;
    // 采集时间
    uint64 accelerometer_timestamp = 5;
    // 陀螺仪 x 轴 角速度
    double gyro_x = 7;
    double gyro_y = 8;
    double gyro_z = 9;
    uint64 gyro_timestamp = 10;

    // 纬度 
    double location_latitude = 11;
    // 经度
    double location_longitude = 12;
    // 高度
    double location_altitude = 13;
    // 速度
    double location_speed = 14;
    
    field_desc accelerometer_desc = 15 ;
    
    field_desc gyro_desc = 16 ;

}

message TelephonyNetwork {
    // 运营商
    bytes carrier_name = 1;
    // 国家地区码
    string iso_country_code = 2;
    // 本地ip
    string cell_ip = 3;
    // wifi ip
    string wifi_ip =4;
    // wifi 网络名称
    string wifi_ssid =5;
    
    string imei1 = 6;
    string imei2 = 7;
    string mei1 = 8;
    string mei2 = 9;
    string iccid = 10;// sim serial number 
    string gsm_version_basebrand = 11; // gsm.version.basebrand
    string carrier_code = 12; // carrier code
    string wifi_mac = 13; // wifi mac address
    string wap_mac=14; // WAP mac address


}


