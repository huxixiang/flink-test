syntax = "proto3";
option java_package = "com.xiaohongshu.ads.service.log.schema";
option java_outer_classname = "AdsEventSchema";

message AdsEvent {
    string user_id = 1;
    string trace_id = 2;
    string request_id = 3;
    repeated AdsNoteInfo data = 4;
    // 时间
    int64 timestamp = 5;
    int32 request_start_position = 6;
    int32 request_size = 7;
    int32 available_ad_position_num = 8;
    int32 inserted_ads_num = 9;
    string ads_city = 10;
    string ads_city_source = 11;
    string ads_country = 12;
    string ads_province = 13;
    int32 ads_gender = 14;
    string ads_age = 15;
    repeated int32 exp_ids = 16;
    string hostname = 17;
    int32 rt = 18;
    string xhs_zone = 19;
}

message AdsNoteInfo {
    string user_id = 1;
    // 笔记 id
    string note_id = 2;
    // adsUUID
    string ads_id = 3;
    // advertiser id
    string advertiser_id = 4;
    // campaign id
    string campaign_id = 5;
    // unit id
    string unit_id = 6;
    // creative id
    string creative_id = 7;
    // 位置
    int32 index = 8;
    // cpm
    double cpm = 9;
    // Ranking Score
    string ranking_score = 10;
    // reason type
    string reason_type = 11;
    // advertiser bid
    double bid = 12;
    // the price that we are going to charge to advertiser
    double price = 13;
    // bid type
    string bid_type = 14;
    // creativity type
    string creativity_type = 15;
    // predicted click through rate
    double pctr = 16;
    // track type
    string track_type = 17;
    // track id
    string track_id = 18;
    // rank position in current request
    int32 rank_position = 19;
    // if inserted in current request
    bool is_inserted = 20;
    // second jump type
    string second_jump_type = 21;
    // Match sucMatchTags
    string suc_match_tags = 22;
    // 0 for not uac, 1 for uac
    int32 uac_tag = 23;
    // 薯条广告作者ID
    string author_id = 24;
    // 时间片实验分组
    repeated string slot_exp_groups = 25;
    // 请求时间
    int64 request_time = 26;
    // 请求时间片
    string request_slot = 27;
    // predicted click conversion rate
    double pcvr = 28;
    // GD成本：下一位竞价广告的ecpm
    double gd_cost_ecpm = 29;
    // GD成本：下一位竞价广告的price
    double gd_cost_price = 30;
    // 出价方式
    int32 bidding_strategy = 31;
    // 粗排打分
    double first_ranking_score = 32;
    // 粗排pctr
    double first_pctr = 33;
    // 封面图优选图片
    string select_url = 34;
    // 封面图策略
    string select_strategy_name = 35;
    // gcpm真实成本
    int32 gcpm_real_cost = 36;
    // 校准前原始pctr
    double ori_pctr = 37;
    // ocpc真实成本
    int32 given_cpa = 38;
    // 新定向信息
    repeated targetInfo target_info = 39;
    // 平台，用于区分新老bp (0 = 老平台，1 = 新平台)
    int32 platform = 40;
    // 标题优选替换的标题名
    string select_title_name = 41;
    // 标题优选策略名称
    string select_title_strategy_name = 42;
    // 封面优选阶段
    int32 select_step = 43;
    // 标题优选阶段
    int32 title_select_step = 44;
    // 出价的定向
    targetInfo selected_target = 45;
    //扩展字段map结构
    string log_json = 46;
}

message targetInfo {
    // 定向id
    int64 target_id = 1;
    // 定向类型
    int32 target_type = 2;
    // match_type
    string mt = 3;
    // 定向出价
    int32 event_bid = 4;
}