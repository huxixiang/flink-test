syntax = "proto3";
option java_package = "com.xiaohongshu.ads.log.search.schema";
option java_outer_classname = "AdsSearchRetrievalEventSchema";

message AdsSearchRetrievalEvent {
  string query = 1;
  string request_id = 2;
  string track_id = 3;
  string search_id = 4;
  string platform = 5;
  string structured_query = 6;
  string user_id = 7;
  int32 placement = 8;
  string origin_query = 9;
  string ads_city = 10;
  string ads_city_source = 11;
  string ads_country = 12;
  string ads_province = 13;
  int32 ads_gender = 14;
  string ads_age = 15;
  repeated int32 exp_ids = 16;
  string query_detail_info = 17;
  repeated AdsSearchInfo ads_info = 18;
}

message AdsSearchInfo {
  string user_id = 1;
  string note_id = 2;
  string ads_id = 3;
  string advertiser_id = 4;
  string campaign_id = 5;
  string unit_id = 6;
  string creative_id = 7;
  string creativity_type = 8;
  string track_type = 9;
  string track_id = 10;
  int64 request_time = 11;
  // 搜索广告专有字段
  string bidword = 12;
  int32 matchtype = 13;
  double matchscore = 14;
  int32 bidword_source = 15;
  int32 submatch_type = 16;
  int32 bidword_flag = 17;
  double duration_score = 18;
  // 点击出价
  int32 bid = 19;
  // 转化出价
  int32 given_cpa = 20;
  // 粗排出价
  double rough_bid = 21;
  double pctr = 22;
  double pcvr = 23;
  string material = 24;
  int32 ocpc_stage = 25;
  string log_json = 26;
  // 相关性过滤原因
  string filter_reason = 27;
  string relevance_detail_info = 28;
  // 召回原因
  string retrieval_strategy = 29;
  // 粗排过滤
  int32 rough_filter_flag = 30;
  // 相关性过滤豁免flag
  int32 relevance_filter_flag = 31;
}
